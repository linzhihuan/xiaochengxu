page { background-color: #f5f5f7; height: 100%; display: flex; flex-direction: column; }

.container { height: 100%; display: flex; flex-direction: column; overflow: hidden; }

/* 导航固定 */
.nav-bar {
  background: #f5f5f7; padding-bottom: 20rpx;
  display: flex; align-items: center; justify-content: space-between;
  padding-left: 30rpx; padding-right: 30rpx; z-index: 100;
  flex-shrink: 0;
}
.back-icon { font-size: 44rpx; width: 60rpx; height: 60rpx; line-height: 60rpx; }
.nav-title { font-weight: 600; font-size: 32rpx; color: #1d1d1f; }
.nav-spacer { width: 60rpx; }

/* 主滚动区 */
.main-scroll { flex: 1; width: 100%; }

/* 预览舞台 */
.preview-stage {
  height: 680rpx;
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  position: relative;
}

.canvas-box {
  width: 500rpx; height: 500rpx;
  position: relative;
  background: #fff;
  box-shadow: 0 40rpx 80rpx rgba(0,0,0,0.08);
  overflow: hidden; /* 关键：裁剪溢出的图片 */
}

/* 层级管理 */
.bg-layer {
  position: absolute; inset: 0; background: #eee; z-index: 1;
}
.photo-layer {
  width: 100%; height: 100%;
  position: absolute; top: 0; left: 0;
  z-index: 5;
  transform-origin: center center; /* 缩放中心 */
  /* 过渡效果会让拖拽有延迟感，建议拖拽时不加 transition，回弹时加 */
}
.mask-layer {
  width: 100%; height: 100%;
  position: absolute; top: 0; left: 0;
  z-index: 10;
  pointer-events: none; /* 关键：让触摸事件穿透遮罩层传给 Canvas */
}
.empty-guide {
  position: absolute; inset: 0; z-index: 8;
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  color: #ccc; pointer-events: none;
}
.plus { font-size: 80rpx; font-weight: 200; }
.tip { font-size: 24rpx; letter-spacing: 2rpx; text-transform: uppercase; margin-top: 10rpx; }

.gesture-hint {
  position: absolute; bottom: 20rpx; width: 100%; text-align: center;
  z-index: 20; pointer-events: none;
}
.gesture-hint text {
  background: rgba(0,0,0,0.4); color: #fff; font-size: 20rpx;
  padding: 6rpx 16rpx; border-radius: 20rpx; backdrop-filter: blur(4px);
}

.preview-caption { margin-top: 40rpx; font-size: 26rpx; color: #86868b; font-weight: 500; }

/* 配置面板 */
.config-panel {
  background: #fff;
  border-top-left-radius: 48rpx; border-top-right-radius: 48rpx;
  padding: 60rpx 40rpx;
  min-height: 500rpx;
  box-shadow: 0 -20rpx 60rpx rgba(0,0,0,0.02);
}

.config-section { margin-bottom: 60rpx; }
.section-title { display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 30rpx; }
.section-title text:first-child { font-size: 28rpx; font-weight: 600; color: #1d1d1f; }
.subtitle { font-size: 22rpx; color: #86868b; }

.picker-scroll { display: flex; height: 160rpx; align-items: center; }
.picker-item {
  width: 140rpx; height: 140rpx; margin-right: 24rpx; border-radius: 24rpx;
  overflow: hidden; position: relative; flex-shrink: 0; background: #f5f5f7;
}
.picker-item image { width: 100%; height: 100%; }
.picker-item.empty { display: flex; align-items: center; justify-content: center; border: 1px dashed #ccc; color: #999; font-size: 24rpx; }
.active-border { position: absolute; inset: 0; border: 6rpx solid #0071e3; border-radius: 24rpx; display: none; }
.picker-item.active .active-border { display: block; }

.style-card {
  width: 180rpx; height: 160rpx; background: #f5f5f7; border-radius: 24rpx; margin-right: 20rpx;
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  flex-shrink: 0; border: 2px solid transparent; transition: all 0.2s;
}
.style-card.active { background: #fff; border-color: #0071e3; box-shadow: 0 10rpx 30rpx rgba(0,113,227,0.1); }
.style-preview { width: 80rpx; height: 80rpx; background: #ddd; border-radius: 12rpx; margin-bottom: 16rpx; }
.style-name { font-size: 22rpx; color: #333; }

.chips-container { display: flex; flex-wrap: wrap; gap: 20rpx; }
.chip {
  padding: 18rpx 36rpx; background: #f5f5f7; border-radius: 40rpx;
  font-size: 26rpx; color: #1d1d1f; border: 1px solid transparent; transition: all 0.2s;
}
.chip.active { background: #1d1d1f; color: #fff; border-color: #1d1d1f; }
.price-mod { font-size: 20rpx; margin-left: 8rpx; opacity: 0.7; }

/* 关键修复：底部占位高度 */
.safe-scroll-padding { height: 220rpx; }

/* 底部操作栏 */
.footer-bar {
  position: absolute; bottom: 0; width: 100%;
  background: rgba(255,255,255,0.9); backdrop-filter: blur(20px);
  padding: 20rpx 40rpx;
  padding-bottom: calc(20rpx + env(safe-area-inset-bottom));
  display: flex; justify-content: space-between; align-items: center;
  border-top: 1px solid rgba(0,0,0,0.05); z-index: 200;
}
.price-block { display: flex; flex-direction: column; }
.price-block .label { font-size: 20rpx; color: #86868b; text-transform: uppercase; }
.price-block .val { font-size: 40rpx; font-weight: 600; color: #1d1d1f; }
.add-btn {
  background: #0071e3; color: #fff; padding: 0 60rpx; height: 90rpx;
  border-radius: 45rpx; font-size: 30rpx; font-weight: 500;
  display: flex; align-items: center; justify-content: center;
  margin: 0; box-shadow: 0 10rpx 20rpx rgba(0,113,227,0.3);
}
.add-btn:active { transform: scale(0.98); }


